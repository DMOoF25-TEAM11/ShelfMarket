<UserControl x:Class="ShelfMarket.UI.Views.UserControls.CashReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:vm="clr-namespace:ShelfMarket.UI.ViewModels"
             mc:Ignorable="d">
    <UserControl.DataContext>
         <!--In real app resolve via DI container--> 
        <vm:CashReportViewModel />
    </UserControl.DataContext>
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="Dato:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <DatePicker SelectedDate="{Binding Date}" Width="150" Margin="0,0,20,0"/>
            <TextBlock Text="Åbningsbeholdning:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBox Text="{Binding OpeningCash, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Width="120"/>
            <Button Content="Opdater" Command="{Binding RefreshCommand}" Margin="107,0,-257,0" Grid.Column="4"/>
        </Grid>

        <Grid Grid.Row="1" Margin="0,12,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <StackPanel>
                <TextBlock Text="Kontantsalg (system)" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CashSalesSystem, StringFormat=C}" />
            </StackPanel>
            <StackPanel>
                <TextBlock Text="Forventet kontant" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding ExpectedCash, StringFormat=C}" />
            </StackPanel>
            <StackPanel>
                <TextBlock Text="Optalt kontant" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CountedCash, StringFormat=C}" />
            </StackPanel>
            <StackPanel>
                <TextBlock Text="Difference" FontWeight="SemiBold"/>
                <TextBlock>
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Text" Value="{Binding Difference, StringFormat=C}"/>
                            <Setter Property="Foreground" Value="Black"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Difference}" Value="0">
                                    <Setter Property="Foreground" Value="DarkGreen"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Difference}">
                                    <DataTrigger.Value>
                                        <system:Decimal>0</system:Decimal>
                                    </DataTrigger.Value>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Difference}" Value="-0">
                                    <Setter Property="Foreground" Value="DarkGreen"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </StackPanel>
            <StackPanel>
                <Button Content="Print" Command="{Binding PrintCommand}" IsEnabled="{Binding CanPrint}" Height="32" Width="100"/>
            </StackPanel>
        </Grid>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <DataGrid ItemsSource="{Binding Denominations}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      HeadersVisibility="Column"
                      Margin="0,0,12,0"
                      IsReadOnly="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Værdi" Binding="{Binding Value, StringFormat=C}" IsReadOnly="True" Width="*"/>
                    <DataGridTextColumn Header="Antal" Binding="{Binding Count, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                    <DataGridTextColumn Header="Beløb" Binding="{Binding Amount, StringFormat=C}" IsReadOnly="True" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>

            <StackPanel Grid.Column="1" Margin="0,0,12,0">
                <TextBlock Text="Notat:" FontWeight="SemiBold"/>
                <TextBox Text="{Binding Note}" AcceptsReturn="True" Height="140" TextWrapping="Wrap"/>
            </StackPanel>

            <Border Grid.Column="2" BorderBrush="#CCC" BorderThickness="1" Padding="8">
                <StackPanel>
                    <TextBlock Text="Ekstra oplysninger" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <TextBlock Text="(Underskrifter printes på rapporten)"/>
                </StackPanel>
            </Border>
        </Grid>

        <TextBlock Grid.Row="3" Foreground="Gray" FontSize="11"
                   Text="Kasserapport skal opbevares jf. bogføringsloven. Sørg for korrekt optælling og underskrift."
                   Margin="0,12,0,0"/>
    </Grid>
</UserControl>